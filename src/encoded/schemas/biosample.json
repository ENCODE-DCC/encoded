{
    "title": "Biosample",
    "description": "Schema for submitting a biosample.",
    "comment": "For cultured samples this object represents unique growths or culture harvests.",
    "id": "/profiles/biosample.json",
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "required": [],
    "identifyingProperties": ["accession"],
    "additionalProperties": false,
    "mixinProperties": [
        {"$ref": "mixins.json#/schema_version"},
        {"$ref": "mixins.json#/dbxrefs"},
        {"$ref": "mixins.json#/description"},
        {"$ref": "mixins.json#/accession"},
        {"$ref": "mixins.json#/treatments"},
        {"$ref": "mixins.json#/diseases"}
    ],
    "dependencies": {
        "post_treatment_time": {
            "required":["post_treatment_time_units", "treatments"],
            "comment": "Biosample with a specified post_treatment_time requires non-empty treatments list and post_treatment_time_units specification.",
            "properties":{
                "treatments": {
                    "minItems": 1
                }
            }
        },
        "post_treatment_time_units": {
            "required":["post_treatment_time", "treatments"],
            "comment": "Biosample with a specified post_treatment_time_units requires non-empty treatments list post_treatment_time specification.",
            "properties":{
                "treatments": {
                    "minItems": 1
                }
            }
        },
        "starting_amount":{
            "required": ["starting_amount_units"],
            "comment": "Biosamples with a specified starting_amount require starting_amount_units to also be specified."
        },
        "starting_amount_units": {
            "required":["starting_amount"],
            "comment": "Biosamples with a specified starting_amount_units require starting_amount to also be specified."
        },
        "preservation_time":{
            "required": ["preservation_time_units"]
        },
        "preservation_time_units": {
            "required":["preservation_time"]
        }
    },
    "properties": {
        "schema_version": {
            "default": "1"
        },
        "accession": {
            "accessionType": "BS"
        },
        "alternate_accessions": {
            "items": {
                "title": "Alternate Accession",
                "description": "An accession previously assigned to an object that has been merged with this object.",
                "comment": "Only accessions of objects that have status equal replaced will work here.",
                "type": "string",
                "format": "accession",
                "pattern": "^(ENCBS\\d{3}[A-Z]{3})$|^(TSTBS\\d{6})$"
            }
        },
        "biosample_ontology": {
            "title": "Biosample ontology",
            "description": "An embedded property for linking to biosample type which describes the ontology of the biosample.",
            "comment": "See biosample_type.json for available identifiers.",
            "type": "string",
            "linkTo": "BiosampleType"
        },
        "description": {
            "elasticsearch_mapping_index_type": {
                "title": "Field mapping index type",
                "description": "Defines one of three types of indexing available",
                "type": "string",
                "default": "analyzed",
                "enum": [
                    "analyzed",
                    "no",
                    "not_analyzed"
                ]
            }
        },
        "treatments": {
            "description": "A list of treatments applied to the biosample.",
            "comment": "A list of treatments applied to the biosample, it is required to be non-empty if post_treatment_time or post_treatment_time_units are specified."
        },
        "diseases": {
            "description": "Known diseases of the specific sample",
            "comment": ""
        },
        "dbxrefs": {
            "items": {
                "title": "External identifier",
                "description": "An identifier from external resource.",
                "type":  "string",
                "pattern": "^((UCSC-ENCODE-cv:[\\S\\s\\d\\-\\(\\)\\+]+)|(GTEx:[a-zA-Z0-9\\-_]+)|(GEO:SAMN\\d+)|(Cellosaurus:CVCL_\\w{4}))$"
            }
        },
        "date_obtained": {
            "title": "Date obtained",
            "description": "The date the biosample was taken, created, or bought.",
            "comment": "Date should be submitted in as YYYY-MM-DD.",
            "type": "string",
            "format": "date"
        },
        "starting_amount": {
            "title": "Starting amount",
            "description": "The initial quantity of cells, tissue or animals obtained.",
            "type": "number",
            "minimum":0
        },
        "starting_amount_units": {
            "title": "Starting amount units",
            "description": "The units used to quantify the amount of cells or tissue obtained.",
            "type": "string",
            "enum": [
                "cells",
                "cells/ml",
                "g",
                "items",
                "mg",
                "whole animals",
                "whole embryos",
                "Î¼g"
            ]
        },
        "post_treatment_time": {
            "title": "Post-treatment time",
            "description": "The time that elapsed past the point when biosamples were treated.",
            "comment": "Use in conjunction with treatment and post_treatment_time_units to specify time elapsed post-treatment. post_treatment_time specification requires non-empty treatments list and post_treatment_time_units specification.",
            "type": "string",
            "pattern": "^(\\d+(\\.[1-9])?(\\-\\d+(\\.[1-9])?)?)|(unknown)$"
        },
        "post_treatment_time_units": {
            "title": "Post-treatment time units",
            "description": "The units of time that elapsed past the point when biosamples were treated.",
            "comment": "Use in conjunction with post_treatment_time and treatment to specify time elapsed post-treatment. post_treatment_time_units specification requires non-empty treatments list and post_treatment_time specification.",
            "type": "string",
            "enum": [
                "minute",
                "hour",
                "day",
                "week",
                "month",
                "stage"
            ]
        },
        "derived_from": {
            "title": "Derived from",
            "description": "The object from which this object was derived.",
            "type": "array",
            "uniqueItems": true
        },
        "derivation_process": {
            "title": "Derivation process",
            "description": "The method(s) by which this object was derived.",
            "type": "array",
            "items": {
                "title": "Derivation process",
                "description": "A method by which this object was derived.",
                "type":  "string"
            }
        },
        "preservation_method": {
            "title": "Preservation method",
            "description": "The method by which the sample was preserved: cryopreservation (slow-freeze) or flash-freezing.",
            "comment": "Indicate the sample preservation_method if known and may be/become an experimental variable to track.",
            "type": "string",
            "enum": [
                "cryopreservation",
                "flash-freezing",
                "n/a (fresh)"
            ]
        },
        "preservation_time": {
            "title": "Preservation time",
            "description": "The length of time that the sample was preserved",
            "type": "integer"
        },
        "preservation_time_units": {
            "title": "Preservation time units",
            "description": "The units of time that the sample was preserved",
            "type": "string",
            "enum": [
                "minute",
                "hour",
                "day",
                "week",
                "month"
            ]
        }
    },
    "changelog": "/profiles/changelogs/biosample.md"
}
